generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model ConnectionTest {
  id Int @id @default(autoincrement())
}

model User {
  id               String    @id @default(uuid())
  email            String    @unique
  password         String
  fullName         String
  phone            String?
  username         String    @unique
  firstName        String?
  middleName       String?
  lastName         String?
  prefix           String?
  suffix           String?
  preferredName    String?
  maidenName       String?
  pronouns         String?
  title            String?
  company          String?
  department       String?
  affiliation      String?
  headline         String?
  accreditations   String?
  emailLink        String?
  phoneLink        String?
  location         String?
  cardName         String?
  cardType         String?   @default("Personal")
  selectedDesign   String?   @default("Classic")
  selectedColor    String?   @default("#145dfd")
  selectedFont     String?   @default("Arial, sans-serif")
  profileImage     String?   @db.Text
  bannerImage      String?   @db.Text
  bio              String?   @db.Text
  status           String?   @default("draft")
  views            Int       @default(0)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  cards            Card[]    @relation("UserCards")
  receivedMessages Message[] @relation("ReceivedMessages")
  sentMessages     Message[] @relation("SentMessages")

  @@index([username])
  @@map("users")
}

model Admin {
  id          String    @id @default(uuid())
  email       String    @unique
  password    String
  fullName    String
  role        AdminRole @default(SUB_ADMIN)
  permissions String    @db.Text
  isActive    Boolean   @default(true)
  createdBy   String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  lastLogin   DateTime?

  @@map("admins")
}

model AdminSession {
  id        String   @id @default(uuid())
  adminId   String
  token     String   @unique @db.VarChar(1000)
  expiresAt DateTime
  createdAt DateTime @default(now())

  @@map("admin_sessions")
}

model Message {
  id         String        @id @default(cuid())
  text       String        @db.Text
  senderId   String
  receiverId String
  status     MessageStatus @default(PENDING)
  read       Boolean       @default(false)
  tag        MessageTag    @default(PRICING)
  createdAt  DateTime      @default(now())
  receiver   User          @relation("ReceivedMessages", fields: [receiverId], references: [id], onDelete: Cascade)
  sender     User          @relation("SentMessages", fields: [senderId], references: [id], onDelete: Cascade)

  @@index([senderId])
  @@index([receiverId])
  @@index([createdAt])
  @@map("messages")
}

model Card {
  id               String   @id @default(cuid()) @map("id")
  userId           String   @map("user_id")
  
  // Personal Information
  fullName         String   @map("full_name") @db.VarChar(255)
  firstName        String?  @map("first_name") @db.VarChar(100)
  middleName       String?  @map("middle_name") @db.VarChar(100)
  lastName         String?  @map("last_name") @db.VarChar(100)
  prefix           String?  @db.VarChar(20)
  suffix           String?  @db.VarChar(20)
  preferredName    String?  @map("preferred_name") @db.VarChar(100)
  maidenName       String?  @map("maiden_name") @db.VarChar(100)
  pronouns         String?  @db.VarChar(50)
  
  // Professional Information
  title            String?  @db.VarChar(255)
  company          String?  @db.VarChar(255)
  department       String?  @db.VarChar(100)
  affiliation      String?  @db.VarChar(255)
  headline         String?  @db.VarChar(500)
  accreditations   String?  @db.Text
  
  // Contact Information
  email            String?  @db.VarChar(320)
  phone            String?  @db.VarChar(50)
  emailLink        String?  @map("email_link") @db.VarChar(500)
  phoneLink        String?  @map("phone_link") @db.VarChar(500)
  location         String?  @db.VarChar(255)
  linkedinUrl      String?  @map("linkedin_url") @db.VarChar(2048)
  websiteUrl       String?  @map("website_url") @db.VarChar(2048)
  
  // Card Customization
  cardName         String?  @map("card_name") @db.VarChar(100)
  cardType         String?  @map("card_type") @default("Personal") @db.VarChar(50)
  selectedDesign   String?  @map("selected_design") @default("Classic") @db.VarChar(50)
  selectedColor    String?  @map("selected_color") @default("#145dfd") @db.VarChar(20)
  selectedFont     String?  @map("selected_font") @default("Arial, sans-serif") @db.VarChar(100)
  displayTypes     String?  @map("display_types") @db.Text
  
  // Media
  profileImage     String?  @map("profile_image") @db.VarChar(2048)
  bannerImage      String?  @map("banner_image") @db.VarChar(2048)
  coverImage       String?  @map("cover_image") @db.VarChar(2048)
  
  // Content
  bio              String?  @db.Text
  description      String?  @db.Text
  
  // Metadata
  status           String?  @default("draft") @db.VarChar(20)
  views            Int      @default(0)
  
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")
  
  user             User     @relation("UserCards", fields: [userId], references: [id], onDelete: Cascade)
  
  @@index([userId])
  @@index([createdAt])
  @@map("cards")
}

model Category {
  id          String   @id @default(cuid())
  name        String   @unique @db.VarChar(255)
  description String?  @db.Text
  icon        String   @default("Briefcase") @db.VarChar(50)
  color       String   @default("#3B82F6") @db.VarChar(7)
  tags        String   @db.LongText
  isActive    Boolean  @default(true)
  userCount   Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([name])
  @@index([isActive])
  @@map("categories")
}

enum AdminRole {
  SUPER_ADMIN
  ADMIN
  SUB_ADMIN
}

enum MessageStatus {
  NEW
  READ
  REPLIED
  PENDING
  ARCHIVED
  DELETED
}

enum MessageTag {
  LEAD
  SUPPORT
  PRICING
  FEEDBACK
}
